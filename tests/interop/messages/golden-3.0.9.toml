version = "3.0.9"

[[messages]]
text = 'rsync: change_dir "<path> failed: No such file or directory (2)'
scenario = "missing_source"

[[messages]]
text = "rsync error: some files/attrs were not transferred (see previous errors) (code 23) at main.c(1070) [sender]"
role = "sender"
scenario = "missing_source"

[[messages]]
text = "rsync: --invalid-option-xyz: unknown option"
scenario = "invalid_option"

[[messages]]
text = "rsync error: syntax or usage error (code 1) at main.c(1453) [client]"
role = "client"
scenario = "invalid_option"

[[messages]]
text = "protocol version mismatch -- is your shell clean?"
scenario = "protocol_version_mismatch"

[[messages]]
text = "(see the rsync man page for an explanation)"
scenario = "protocol_version_mismatch"

# Race-dependent: At least one protocol/IPC error must appear
[[message_groups]]
name = "protocol_mismatch_errors"
scenario = "protocol_version_mismatch"
require_at_least = 1
messages = [
    { pattern = "rsync error: protocol incompatibility \\(code 2\\) at compat\\.c\\(\\d+\\) \\[.*\\]" },
    { pattern = "rsync error: received SIGUSR1 \\(code 19\\) at main\\.c\\(\\d+\\) \\[.*\\]" },
    { pattern = "rsync error: error in IPC code \\(code 14\\) at io\\.c\\(\\d+\\) \\[sender\\]", role = "sender" },
]

[[messages]]
text = 'rsync: change_dir "/nonexistent/source" failed: No such file or directory (2)'
scenario = "source_not_found"

[[messages]]
text = "rsync error: some files/attrs were not transferred (see previous errors) (code 23) at main.c(1070) [sender]"
role = "sender"
scenario = "source_not_found"

[[messages]]
text = "rsync: failed to connect to localhost (::1): Connection refused (111)"
scenario = "daemon_connection_refused"

[[messages]]
text = "rsync: failed to connect to localhost (127.0.0.1): Connection refused (111)"
scenario = "daemon_connection_refused"

[[messages]]
text = "rsync error: error in socket IO (code 10) at clientserver.c(122) [Receiver=3.0.9]"
scenario = "daemon_connection_refused"

[[messages]]
text = 'rsync: send_files failed to open "<path>: Permission denied (13)'
scenario = "permission_denied_read"

[[messages]]
text = "rsync error: some files/attrs were not transferred (see previous errors) (code 23) at main.c(1070) [sender]"
role = "sender"
scenario = "permission_denied_read"

[[messages]]
text = 'rsync: change_dir#1 "<path> failed: Permission denied (13)'
scenario = "permission_denied_write"

[[messages]]
text = "rsync error: errors selecting input/output files, dirs (code 3) at main.c(562) [Receiver=3.0.9]"
scenario = "permission_denied_write"

[[messages]]
text = "rsync: connection unexpectedly closed (9 bytes received so far) [sender]"
role = "sender"
scenario = "permission_denied_write"

[[messages]]
text = "rsync error: error in rsync protocol data stream (code 12) at io.c(605) [sender]"
role = "sender"
scenario = "permission_denied_write"

[[messages]]
text = 'rsync: send_files failed to open "<path>: Permission denied (13)'
scenario = "partial_transfer"

[[messages]]
text = "rsync error: some files/attrs were not transferred (see previous errors) (code 23) at main.c(1070) [sender]"
role = "sender"
scenario = "partial_transfer"

[[messages]]
text = "rsync: --delete does not work without --recursive (-r) or --dirs (-d)."
scenario = "max_delete_limit"

[[messages]]
text = "rsync error: syntax or usage error (code 1) at main.c(1453) [client]"
role = "client"
scenario = "max_delete_limit"

[[messages]]
text = "rsync: Failed to exec /nonexistent/shell: No such file or directory (2)"
scenario = "remote_not_found"

[[messages]]
text = "rsync error: error in IPC code (code 14) at pipe.c(84) [sender]"
role = "sender"
scenario = "remote_not_found"

# Race-dependent: At least one IPC/connection error must appear after exec failure
[[message_groups]]
name = "remote_not_found_errors"
scenario = "remote_not_found"
require_at_least = 1
messages = [
    { pattern = "rsync: writefd_unbuffered failed to write \\d+ bytes to socket \\[sender\\]: Broken pipe.*", role = "sender" },
    { pattern = "rsync error: error in IPC code \\(code 14\\) at io\\.c\\(\\d+\\) \\[sender\\]", role = "sender" },
    { pattern = "rsync: connection unexpectedly closed.*\\[sender\\]", role = "sender" },
]
