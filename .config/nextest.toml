# Nextest defaults: keep full workspace filter while relying on CLI flags for package selection.
[profile.default]
default-filter = "all()"
status-level = "fail"
final-status-level = "fail"
failure-output = "immediate-final"

[profile.ci]
default-filter = "all()"
status-level = "fail"
final-status-level = "fail"
failure-output = "immediate-final"
success-output = "never"
# Per-test timeout: fail individual tests that hang rather than hitting CI job timeout.
slow-timeout = { period = "120s", terminate-after = 3 }
# Generate JUnit XML for CI dashboards (optional, not currently used)
# junit.path = "junit.xml"

# Retry policies for tests with inherent race conditions (port binding TOCTOU,
# slow CI runner timing).
[[profile.ci.overrides]]
filter = "package(daemon) | test(execute_sparse) | binary_id(~integration_daemon)"
retries = 2
